diff --git a/PKGBUILD b/PKGBUILD
index f30385b..c41cbda 100644
--- a/PKGBUILD
+++ b/PKGBUILD
@@ -37,6 +37,9 @@ build(){
     -compressdwarf=false \
     -linkmode=external \
   "
+  go mod edit -replace=github.com/creack/goselect=github.com/creack/goselect@v0.1.3
+  go mod tidy
+  go mod vendor
   go build -v -ldflags "$ld_flags" -o build/
 }
 
@@ -47,6 +50,8 @@ check() {
       | grep -v github.com/arduino/arduino-cli/internal/arduino/monitor \
       | grep -v github.com/arduino/arduino-cli/internal/integrationtest \
       | grep -v github.com/arduino/arduino-cli/internal/version \
+      | grep -v github.com/arduino/arduino-cli/internal/arduino/cores/packagemanager \
+      | grep -v github.com/arduino/arduino-cli/internal/cli/arguments \
   )
   # shellcheck disable=SC2086
   go test -v $unit_tests
